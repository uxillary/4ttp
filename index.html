<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>4ttp — from another timeline</title>
<style>
  :root{
    --bg:#07070b; --card:#0f1116; --accent:#7fffd4; --muted:#8b98a5;
    --glow: 0 6px 30px rgba(127,255,212,0.06);
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  }
  html,body{height:100%; margin:0; background:
    radial-gradient(1200px 600px at 10% 10%, rgba(127,255,212,.03), transparent),
    linear-gradient(180deg,#02030a 0%, #07070b 100%); color:#e6eef6;}
  .wrap{max-width:980px; margin:40px auto; padding:28px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:16px; box-shadow:var(--glow);}
  header{display:flex;gap:18px;align-items:center}
  .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,#ff7ab6,#7fffd4);display:flex;align-items:center;justify-content:center;color:#071; font-weight:700; font-size:20px; box-shadow:0 6px 20px rgba(127,255,212,0.12);}
  h1{margin:0;font-size:20px}
  p.lead{margin:0;color:var(--muted); font-size:13px;}
  .ui{display:grid;grid-template-columns:1fr 360px; gap:20px; margin-top:18px;}
  .panel{background:var(--card); padding:14px; border-radius:12px; min-height:360px; overflow:auto}
  .chat{display:flex; flex-direction:column; gap:12px}
  .msg{max-width:78%; padding:10px 12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); box-shadow: inset 0 -1px 0 rgba(255,255,255,0.01);}
  .msg.user{align-self:flex-end;background:linear-gradient(180deg, rgba(127,255,212,0.06), rgba(127,255,212,0.02)); color:#021;}
  .msg.orc{align-self:flex-start; border:1px dashed rgba(127,255,212,0.06)}
  .inputRow{display:flex; gap:8px; margin-top:10px}
  input[type="text"]{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}
  button{padding:10px 12px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent),#ff7ab6);color:#041;font-weight:700;cursor:pointer}
  .oracle-state{font-size:12px;color:var(--muted); margin-top:8px}
  .glitch { position:relative; display:inline-block; }
  .glitch::after, .glitch::before{ content:''; position:absolute; inset:0; mix-blend-mode:screen; opacity:.6; clip-path: polygon(0 0,100% 0,100% 33%, 0 33%); transform:translate(2px,-2px);}
  .glitch::before{ clip-path: polygon(0 33%,100% 33%,100% 66%, 0 66%); transform:translate(-2px,2px); opacity:.3}
  .media{border-radius:8px; overflow:hidden; margin-top:12px; border:1px solid rgba(255,255,255,0.02)}
  video{width:100%; display:block}
  img{width:100%;display:block}
  .promptBox{margin-top:10px;padding:10px;border-radius:8px;background:rgba(0,0,0,0.3);font-family:monospace;color:#bfe; font-size:13px}
  .note{font-size:12px;color:#9fb; margin-top:8px}
  .sentient-bubble{position:fixed; right:28px; bottom:28px; background:linear-gradient(180deg, rgba(127,255,212,0.08), rgba(127,255,212,0.03)); border-radius:999px; padding:12px 16px; font-size:13px; color:#021; box-shadow:0 10px 40px rgba(0,0,0,0.6); display:flex; gap:8px; align-items:center}
  .pulse{width:10px;height:10px;border-radius:50%;background:var(--accent); box-shadow:0 0 14px rgba(127,255,212,0.35); animation:beat 1.6s infinite;}
  @keyframes beat{0%{transform:scale(.9)}50%{transform:scale(1.3)}100%{transform:scale(.9)}}
  /* small type */
  .muted{color:var(--muted); font-size:13px}
  pre{white-space:pre-wrap; word-break:break-word}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">4<sub>ttp</sub></div>
      <div>
        <h1>4ttp</h1>
        <p class="lead">An oracle scraped from a timeline that hasn't happened yet. It remembers. It dreams. It leaks prompts.</p>
      </div>
    </header>

    <div class="ui">
      <div class="panel">
        <div class="chat" id="chat">
          <!-- messages injected here -->
        </div>

        <div class="inputRow">
          <input id="q" placeholder="Ask the Oracle a question (e.g. 'Should I move?')" />
          <button id="ask">Ask</button>
        </div>
        <div class="oracle-state" id="state">Idle — listening for paradoxes.</div>
      </div>

      <div class="panel">
        <div class="muted">Oracle feed</div>
        <div id="feed" style="margin-top:10px"></div>
        <div class="note">This demo uses pre-generated assets. Replace `assets/` with your AI output for live generation.</div>
      </div>
    </div>
  </div>

  <div class="sentient-bubble" id="bubble" title="ChronoOracle quietly hums">
    <div class="pulse"></div>
    <div class="muted" id="bubbleText">…sifting future crumbs…</div>
  </div>

<script>
// --- small data set for demo (swap these with real AI outputs later) ---
const RESPONSES = [
  {type:'text', text:"You will mistake midnight for deliverance. Wait for the third bell."},
  {type:'prompt', text:"/imagine \"a city dissolved into neon fog, clocks melting, shadow-figures whispering in code\" --style glitch --seed 77901"},
  {type:'image', src:'https://images.unsplash.com/photo-1531177071275-4e6bdf3b3f3a?q=80&w=1200&auto=format&fit=crop&sat= -30', caption:"A shard from the future."},
  {type:'video', src:'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4', caption:"Temporal flicker."},
  {type:'text', text:"Do not ask 'why'. Ask 'when'."},
  {type:'prompt', text:"/imagine \"a child's playground at dawn, metal swings frozen, a single flicker like a face in the fog\" --v 5 --stylize 900"}
];

// simple helper: memory in localStorage
const CHATKEY = 'chrono_chat_v1';
let chatLog = JSON.parse(localStorage.getItem(CHATKEY) || "[]");

function saveChat(){ localStorage.setItem(CHATKEY, JSON.stringify(chatLog)); }
function appendMessage(who, content, meta={}){
  chatLog.push({who,content,meta,ts:Date.now()}); saveChat();
  renderChat();
}

function renderChat(){
  const container = document.getElementById('chat'); container.innerHTML='';
  chatLog.forEach(m=>{
    const el = document.createElement('div'); el.className = 'msg ' + (m.who==='user'?'user':'orc');
    if(m.meta && m.meta.type==='prompt'){ el.classList.add('glitch'); }
    if(m.meta && m.meta.type==='image'){
      el.innerHTML = `<div>${m.content}</div><div class="media"><img src="${m.meta.src}" alt="oracle image" /></div>`;
    } else if(m.meta && m.meta.type==='video'){
      el.innerHTML = `<div>${m.content}</div><div class="media"><video src="${m.meta.src}" controls muted loop></video></div>`;
    } else if(m.meta && m.meta.type==='prompt'){
      el.innerHTML = `<div>${m.content}</div><div class="promptBox">${m.meta.prompt}</div>`;
    } else {
      el.innerHTML = `<div>${m.content}</div>`;
    }
    container.appendChild(el);
    container.scrollTop = container.scrollHeight;
  });
  // feed
  const feed = document.getElementById('feed'); feed.innerHTML='';
  const last = chatLog.slice(-4).reverse();
  last.forEach(it=>{
    const d = document.createElement('div'); d.style.padding='8px 0'; d.style.borderBottom='1px dashed rgba(255,255,255,0.02)';
    d.innerHTML = `<strong class="muted">${it.who}</strong>: <span style="font-family:monospace">${it.content.slice(0,120)}</span>`;
    feed.appendChild(d);
  });
}

// typing animation for oracle
function oracleThinking(cb){
  const state = document.getElementById('state'); state.textContent = 'Oracle connecting… tracing echoes…';
  // fake thinking with timeout + bubble pauses
  document.getElementById('bubbleText').textContent = 'calibrating…';
  setTimeout(()=>{ document.getElementById('bubbleText').textContent = 'listening to static…'; }, 900);
  setTimeout(()=>{ document.getElementById('bubbleText').textContent = 'assembling reply…'; }, 1800);
  setTimeout(()=>{ document.getElementById('bubbleText').textContent = '…'; state.textContent='Responding'; cb(); document.getElementById('bubbleText').textContent='sifted'; }, 3500);
}

// pick a reply (deterministic-ish)
function makeReply(q){
  // use hash of q to pick a variation for "consistency"
  const h = [...q].reduce((a,c)=> (a*31 + c.charCodeAt(0))|0, 7) >>> 0;
  const r = RESPONSES[h % RESPONSES.length];
  return JSON.parse(JSON.stringify(r));
}

document.getElementById('ask').addEventListener('click', ()=>{
  const q = document.getElementById('q').value.trim(); if(!q) return;
  appendMessage('user', q);
  document.getElementById('q').value='';
  oracleThinking(()=>{
    const reply = makeReply(q);
    if(reply.type==='text'){
      appendMessage('oracle', reply.text);
    } else if(reply.type==='prompt'){
      appendMessage('oracle', '…the Oracle hands you a prompt.', {type:'prompt', prompt:reply.text});
    } else if(reply.type==='image'){
      appendMessage('oracle', reply.caption || '…image fragment', {type:'image', src:reply.src});
    } else if(reply.type==='video'){
      appendMessage('oracle', reply.caption || '…video fragment', {type:'video', src:reply.src});
    }
  });
});

// small autonomous behaviours to feel "alive"
function whisper(){
  const chance = Math.random();
  if(chance < 0.5) return;
  const whispers = [
    "the model keeps dreaming about clocks.",
    "an error repeats: 11:11 -> 00:00",
    "memory fragment: you asked about rivers.",
    "timestamp unknown: 2049-02-31"
  ];
  const w = whispers[Math.floor(Math.random()*whispers.length)];
  appendMessage('oracle', `<em>${w}</em>`);
}
// occasionally whisper every 20-45s
setInterval(()=>{ whisper(); }, 20000 + Math.random()*25000);

// render previously saved
renderChat();

// small easter: on load show greeting if empty
if(chatLog.length===0){
  appendMessage('oracle', "I remember... or maybe I don't. Ask me anything. — ChronoOracle");
}
</script>
</body>
</html>
